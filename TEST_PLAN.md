# 测试计划与验收标准（MVP）

## 1. 测试目标

验证系统是否满足以下能力：
- 音频可接收并自动归档
- 标签识别可用且可人工修正
- 老师指令可解析为结构化需求
- Daily 打包正确执行“每条目最多 2 条”
- 报告能准确反映覆盖率与缺遍

## 2. 测试环境

- 操作系统：Windows（优先）
- 目录根：项目根目录
- 样本：3~5 条测试音频，覆盖词汇/句子/快嘴至少各 1 条

## 3. 用例清单

## TC-01 启动初始化

前置：无 `HomeworkVault/` 或无 `mappings.json`。  
步骤：
1. 启动后端服务。
2. 检查目录与配置文件。  
期望：
1. 自动创建标准目录结构。
2. 自动生成全量 `mappings.json`（17/15/6）。

## TC-02 Inbox 上传

前置：服务已启动。  
步骤：
1. 在 Inbox 页面上传 2 条音频。  
期望：
1. 文件落盘 `HomeworkVault/Inbox/`。
2. 列表可见文件名和处理状态。

## TC-03 扫描与自动处理

前置：`Inbox` 存在未处理音频。  
步骤：
1. 触发扫描处理。  
期望：
1. 完成 ASR 与标签抽取。
2. 文件按 type/index 归档到 `Library`。
3. 库内文件名符合 `take_YYYYMMDD_HHMMSS.m4a`。

## TC-04 低置信人工修正

前置：存在 `confidence < 0.75` 样本。  
步骤：
1. 在 UI 手动调整 type/index/title 并保存。  
期望：
1. 标签更新成功。
2. 文件归档路径与目标条目一致。

## TC-05 老师指令解析

前置：无。  
步骤：
1. 输入示例指令：`句子五、句子8，词汇七和11，快嘴第三篇`。
2. 点击解析。  
期望：
1. 输出 `SENTENCE [5,8]`、`VOCAB [7,11]`、`FASTSTORY [3]`。
2. 结果已去重并排序。

## TC-06 Daily 打包

前置：Library 中有多个条目与不同 take 数量。  
步骤：
1. 基于解析结果点击“生成今日文件夹”。  
期望：
1. 生成 `Daily/YYYY-MM-DD/`。
2. 每个需求条目最多复制 2 条，默认选择最新两条。
3. 可用不足 2 条时仅复制可用数。

## TC-07 报告正确性

前置：已完成 TC-06。  
步骤：
1. 打开 `_report.txt`。  
期望：
1. 包含日期与老师指令原文。
2. 包含需求清单（编号+标题）。
3. 覆盖率统计正确，缺遍项与数量正确。

## TC-08 日志可追溯

前置：运行过完整流程。  
步骤：
1. 查看日志。  
期望：
1. 至少包含：入队、ASR、规则命中、LLM 调用、归档、打包。
2. 失败时有可定位错误信息。

## 4. MVP 验收门槛

以下全部通过即验收通过：
1. TC-01 至 TC-08 全部通过。
2. 无阻塞级错误（P0/P1）。
3. 关键路径（上传 -> 归档 -> 解析 -> 打包 -> 报告）可端到端完成。

## 5. 回归建议

- 每次调整 `mappings.json` 后，至少执行 TC-03、TC-05、TC-06、TC-07。
- 每次调整规则或 Prompt 后，至少新增 1 条失败样本做回归。

